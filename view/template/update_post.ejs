<?- include('./common/layout_pre.ejs', { title : 'Update', name : locals.name }) ?>

<? if
(
    locals.name !== false &&
    locals.content &&
    locals.by &&
    locals.createdAt &&
    locals.updatedAt &&
    locals.id
) { ?>
<form method='POST' action='/post/<?= id ?>/update'>
    <div>
        <label for='content'>Edit your content here:</label>
    </div>
    <div>
        <textarea
            style='height: 30vw'
            name='content'
            type='text'
            placeholder='Enter your content here'
            minlength='1'
            autocomplete='off'
            required><?= content ?></textarea>
    </div>
    <? if(locals.info) { ?>
    <div>
        <?= info ?>
    </div>
    <? } ?>
    <div>
        <button class='submit' type='submit'>Publish change</button>
    </div>
</form>
<br>
<form method='GET' action='/post/<?= id ?>/delete'>
    <input type='hidden' name='username' value='<?= by ?>'>
    <button type='submit'>Delete</button>
</form>
<form method='GET' action='/post/<?= id ?>'>
    <button class='submit' type='submit'>Go back to post</button>
</form>
<? } else { ?>
    You must be signed in and author of the post to edit it
<? } ?>

<?- include('./common/layout_post.ejs') ?>